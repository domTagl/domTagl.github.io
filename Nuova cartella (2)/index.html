<!DOCTYPE html>
<html>
<head>
  <title>Document</title>
  <!-- Importa la libreria jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Definizione dello stile CSS -->
  <style>
    #campo-minato {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      grid-template-rows: repeat(10, 1fr);
      width: 500px;
      height: 500px;
    }
    
    /* Definisce lo stile di ogni casella */
    .casella {
      border: 1px solid black;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      background-color: green; /* Aggiunge il colore verde di sfondo */
      color: transparent; /* Rende il testo al suo interno non visibile */
    }
    
    /* Definisce lo stile della casella contenente la bomba */
    .bomba {
      color: green;
    }
    
    /* Aggiunge la regola per mostrare il testo al clic */
    .casella.clicked {
      background-color: transparent;
      color: black;
    }
  </style>
  <!-- Definizione dello script JavaScript -->
  <script>
    function creaCampo() {
      var campo = $("#campo-minato"); // seleziona il div contenitore del campo
      campo.empty(); // svuota il contenitore
      var campoMatrice = []; // matrice per rappresentare il campo minato
      for (var i = 0; i < 10; i++) {
        campoMatrice[i] = []; // inizializza una riga vuota nella matrice
        for (var j = 0; j < 10; j++) {
          campoMatrice[i][j] = 0; // inizializza a 0 il numero di mine adiacenti
        }
      }
      var mine = [];
      for (var i = 0; i < 10; i++) {
        var x = Math.floor(Math.random() * 10); // genera una coordinata x casuale
        var y = Math.floor(Math.random() * 10); // genera una coordinata y casuale
        mine.push([x, y]); // aggiungi la posizione della mina all'array delle mine
        // incrementa il contatore di tutte le celle adiacenti
        for (var a = Math.max(0, x - 1); a <= Math.min(9, x + 1); a++) {
          for (var b = Math.max(0, y - 1); b <= Math.min(9, y + 1); b++) {
            campoMatrice[a][b]++; // incrementa il contatore di mine adiacenti
          }
        }
      }
      for (var i = 0; i < 100; i++) {
        var casella = $("<div/>"); // crea un elemento div per rappresentare la casella
        casella.addClass("casella"); // aggiungi la classe "casella" all'elemento
        var x = Math.floor(i / 10); // calcola la riga della casella corrente
        var y = i % 10; // calcola la colonna della casella corrente
        if (mine.some(m => m[0] === x && m[1] === y)) { // se la casella contiene una mina
          casella.addClass("bomba"); // aggiungi la classe "bomba" all'elemento
          casella.text("B"); // aggiungi il testo "M" all'elemento
        } else {
          casella.text(campoMatrice[x][y]); // aggiungi il numero di mine adiacenti come testo dell'elemento
        }
        campo.append(casella); // aggiungi l'elemento al contenitore del campo
      }
    }
    
  </script>

  <script>
    $(document).on("click", ".casella", function() {
      $(this).addClass("clicked");
      if($(this).text() == "B"){
        alert("la bomba Ã¨ stata schiacciata, hai perso"); 
      }
    });
  </script>

</head>
<body>
  <!-- Aggiunge un bottone per creare il campo minato -->
  <input type="button" onclick="creaCampo()" value="Crea campo">
  <!-- Crea un div vuoto con id "campo-minato" dove verranno aggiunte le caselle -->
  <div id="campo-minato"></div>
</body>
</html>
